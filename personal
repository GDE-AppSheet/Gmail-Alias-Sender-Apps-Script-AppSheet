/**
 * Gmail Sender (Propia Cuenta)
 * --------------------------------
 * Env칤a correos electr칩nicos directamente **desde la cuenta ejecutora**
 * (la misma que ejecuta el script) usando `MailApp`.
 *
 * Diferencias respecto a GmailApp:
 * - `MailApp` usa el remitente de la cuenta propietaria del script (no admite alias).
 * - Ideal para automatizaciones, reportes internos, o recordatorios.
 *
 * Requisitos:
 * - El script debe ejecutarse con una cuenta que tenga permiso de env칤o (p. ej. tu propia cuenta de Gmail).
 * - No se necesita configuraci칩n de alias ni "Enviar como".
 *
 * Seguridad / Privacidad:
 * - No dejes correos reales ni nombres propios en el c칩digo.
 * - Usa placeholders o variables configuradas v칤a PropertiesService.
 *
 * @example
 * sendFromExecutor('destinatario@ejemplo.com', 'Reporte Diario', '<p>Hola, este es el resumen...</p>');
 *
 * @author TuNombre
 * @license MIT
 */

/**
 * Env칤a un correo electr칩nico usando la cuenta ejecutora del script.
 *
 * @param {string} recipient - Direcci칩n de correo del destinatario.
 * @param {string} subject - Asunto del correo.
 * @param {string} body - Cuerpo del mensaje en formato HTML.
 * @returns {{ok: boolean, mode: string, to: string}} Resumen del env칤o.
 *
 * @throws {Error} Si faltan par치metros o el env칤o falla.
 */
function sendFromExecutor(recipient, subject, body) {
  if (!recipient || !subject || !body) {
    throw new Error('Par치metros insuficientes: recipient, subject y body son obligatorios.');
  }

  MailApp.sendEmail({
    to: recipient,
    subject: subject,
    htmlBody: body,
    noReply: false // permite responder directamente al remitente original
  });

  Logger.log('Correo enviado correctamente desde la cuenta ejecutora hacia %s', recipient);
  return { ok: true, mode: 'MailApp', to: recipient };
}

/**
 * (Opcional) Prueba de env칤o local.
 * - Reemplaza los placeholders antes de ejecutar.
 * - Solo env칤a desde TU cuenta (no requiere alias).
 */
function __test_sendFromExecutor() {
  const RECIPIENT = 'destinatario@ejemplo.com'; // TODO: cambiar
  const SUBJECT   = 'Prueba de env칤o desde cuenta ejecutora';
  const BODY      = '<p>Hola 游녦, este es un correo enviado <strong>desde mi propia cuenta</strong>.</p>';

  try {
    const result = sendFromExecutor(RECIPIENT, SUBJECT, BODY);
    Logger.log(JSON.stringify(result));
  } catch (err) {
    Logger.log('Error en __test_sendFromExecutor: %s', err.message || err);
    throw err;
  }
}
